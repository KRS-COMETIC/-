<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>今日の斑鳩ルカ</title>
<style>
  body {
    margin: 0;
    font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;
    background: linear-gradient(180deg, #0f1a2b, #1c2f4a);
    color: #fff;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .card {
    width: 90%;
    max-width: 380px;
    background: rgba(255,255,255,0.08);
    backdrop-filter: blur(8px);
    border-radius: 20px;
    padding: 24px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.4);
    text-align: center;
  }
  .title { font-size: 22px; letter-spacing: 0.1em; margin-bottom: 8px; }
  .subtitle { font-size: 13px; opacity: 0.7; margin-bottom: 20px; }
  .luka { font-size: 40px; margin-bottom: 10px; }
  #result { font-size: 16px; line-height: 1.6; min-height: 4em; margin: 20px 0; opacity: 0; transition: opacity 0.3s ease, font-size 0.3s ease; }
  button { width: 100%; padding: 14px; font-size: 16px; border: none; border-radius: 999px; background: linear-gradient(90deg,#6fb1ff,#8fd3f4); color: #0f1a2b; font-weight: bold; cursor: pointer; transition: opacity 0.2s ease, transform 0.1s ease; }
  button:active { transform: scale(0.98); }
  button:disabled { cursor: default; opacity: 0.5; }
  footer { margin-top: 16px; font-size: 11px; opacity: 0.5; }
</style>
</head>
<body>
<div class="card">
  <div class="luka">❄️</div>
  <div class="title">今日の斑鳩ルカ</div>
  <div class="subtitle">Ikaruga Luca says…</div>
  <div id="result"></div>
  <button id="lucaButton">今日の斑鳩</button>
  <footer>※非公式ファンコンテンツ</footer>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const lucaWords = [
    "……無理はしない。今日はそれでいい。",
    "周りに合わせすぎ。少し、自分を優先して。",
    "静かな時間が、答えをくれると思う。",
    "今は準備のとき。焦る必要はない。",
    "やるなら、最後まで。中途半端は嫌い。",
    "今日は、ちゃんと休みなよ。",
    "大丈夫。思ってるより、ちゃんと出来てる。"
  ];

  const button = document.getElementById("lucaButton");
  const result = document.getElementById("result");

  // クリック回数を保持
  let clickCount = parseInt(localStorage.getItem("lucaClicks") || "0", 10);

  function chaosEffect() {
    document.body.innerHTML = ""; // ページを白紙化
    const container = document.createElement("div");
    container.style.fontSize = "24px";
    container.style.fontFamily = "monospace";
    container.style.color = "lime";
    container.style.background = "#000";
    container.style.height = "100vh";
    container.style.display = "flex";
    container.style.justifyContent = "center";
    container.style.alignItems = "center";
    container.style.flexDirection = "column";
    document.body.appendChild(container);

    let count = 0;
    const interval = setInterval(() => {
      container.textContent = "";
      for(let i=0;i<50;i++){
        const charCode = 0x30 + Math.floor(Math.random()*95); // ASCII 0x30〜0x7E
        container.textContent += String.fromCharCode(charCode);
      }
      count++;
      if(count > 30){
        clearInterval(interval);
        container.textContent = "ルカは怒って帰っちゃいました…";
        setTimeout(() => {
          try { window.close(); } catch(e){}
        }, 3000);
      }
    }, 100);
  }

  function showMessage() {
    clickCount++;
    localStorage.setItem("lucaClicks", clickCount);

    switch(clickCount) {
      case 1:
        result.style.fontSize = "16px";
        result.textContent = lucaWords[Math.floor(Math.random() * lucaWords.length)];
        result.style.opacity = 1;
        break;
      case 2:
        result.style.fontSize = "16px";
        result.textContent = "(もう終わりだ・・・)";
        result.style.opacity = 1;
        break;
      case 3:
        result.style.fontSize = "16px";
        result.textContent = "(・・・・・・)";
        result.style.opacity = 1;
        break;
      default:
        chaosEffect(); // 4回目以降でノイズ化＋帰る演出
        button.disabled = true;
        break;
    }
  }

  button.addEventListener("click", showMessage);
});
</script>
</body>
</html>